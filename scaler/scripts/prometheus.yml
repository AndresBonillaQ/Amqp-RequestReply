global:
  scrape_interval: 15s # How often to scrape targets

scrape_configs:
  # --- 1. RABBITMQ METRICS ---
  - job_name: 'rabbitmq-exporter'
    static_configs:
      - targets: ['rabbitmq-exporter:9419']
    metrics_path: /metrics
    basic_auth: # Authentication for the Management API
      username: guest
      password: guest

  # --- 2. MICROSERVICE METRICS ---

  # Static job for the Publisher microservice
  - job_name: 'publisher'
    static_configs:
      - targets: ['publisher:8080'] # Publisher container hostname and metrics port
    metrics_path: /actuator/prometheus # Standard endpoint for Spring Boot Actuator/Micrometer

  # Dynamic job for Subscribers (Autoscaling targets)
  #- job_name: 'dynamic-subscribers'
  #  file_sd_configs:
  #    - files:
  #        - '/etc/prometheus/targets/subscribers.json' # File containing all dynamically deployed subscribers
  #      refresh_interval: 10s # How often to check the file for changes (Service Discovery)